"""
    This implementation of DDPM closely follows:
    https://huggingface.co/blog/annotated-diffusion
"""